# **Robo-Creator å‰ç«¯æ¶æ„ä¸å¼€å‘æŒ‡å—**

# **(Frontend Architecture & Development Guide)**

**ç‰ˆæœ¬**ï¼š3.4 (i18n & AI-Ready Edition)

**æ—¥æœŸ**ï¼š2026-02

**é€‚ç”¨å¯¹è±¡**ï¼šé«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆã€AI è¾…åŠ©å¼€å‘è€… (Cursor/Gemini)

**æ ¸å¿ƒç›®æ ‡**ï¼šæ„å»ºå·¥ä¸šçº§ Web 3D ç¼–è¾‘å™¨ï¼Œ**åŸç”Ÿæ”¯æŒå›½é™…åŒ–**ï¼Œä¸ºäºŒæœŸ AI ç”ŸæˆåŠŸèƒ½é¢„ç•™æ¶æ„æ¥å£ã€‚

## **1\. æ ¸å¿ƒæ¶æ„å“²å­¦ (Core Philosophy)**

1. **Locale-First (å›½é™…åŒ–ä¼˜å…ˆ)**ï¼š  
   * **è·¯ç”±æ¶æ„**ï¼šé‡‡ç”¨ /\[locale\]/... ç»“æ„ï¼Œä¸€å¼€å§‹å°±æ”¯æŒå¤šè¯­è¨€ï¼ˆå³ä½¿ MVP åªæœ‰ä¸­æ–‡ï¼Œä¹Ÿè¦å¥—åœ¨è¿™ä¸ªç»“æ„é‡Œï¼‰ã€‚  
   * **ç¡¬ç¼–ç é›¶å®¹å¿**ï¼šUI ç»„ä»¶ä¸­ä¸¥ç¦å‡ºç°ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ "ä¿å­˜"ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨ t('save')ã€‚  
2. **State-Driven (çŠ¶æ€é©±åŠ¨)**ï¼š  
   * UI å±‚ï¼ˆDOMï¼‰ä¸ 3D å±‚ï¼ˆCanvasï¼‰**ç»ä¸ç›´æ¥é€šä¿¡**ï¼Œé€šè¿‡ **Zustand** åŒæ­¥ã€‚  
3. **Client-First (å®¢æˆ·ç«¯ä¼˜å…ˆ)**ï¼š  
   * ç¼–è¾‘å™¨æ ¸å¿ƒ (/editor) å¼ºåˆ¶ 'use client'ã€‚  
   * 3D æ¸²æŸ“ã€ç‰©ç†æ ¡éªŒã€æ–‡ä»¶ç”Ÿæˆå…¨éƒ¨åœ¨æµè§ˆå™¨ä¸»çº¿ç¨‹è¿è¡Œã€‚

## **2\. æŠ€æœ¯æ ˆæ·±åº¦é€‰å‹ (The Stack)**

| æ¨¡å— | é€‰å‹ | å…³é”®åº“/ç‰ˆæœ¬ | è¯´æ˜ |
| :---- | :---- | :---- | :---- |
| **Framework** | **Next.js** | v14+ (App Router) | å…¨æ ˆæ¡†æ¶ã€‚ |
| **i18n** | **Next-Intl** | next-intl | **æ–°å¢**ï¼šå¤„ç†å¤šè¯­è¨€è·¯ç”±å’Œç¿»è¯‘æ–‡ä»¶ã€‚ |
| **AI SDK** | **Vercel AI SDK** | ai, @ai-sdk/google | **é¢„ç•™**ï¼šäºŒæœŸ AI ç”ŸæˆåŠŸèƒ½çš„æ ¸å¿ƒåº“ã€‚ |
| **3D Core** | **R3F Ecosystem** | @react-three/fiber | æ ¸å¿ƒæ¸²æŸ“å¼•æ“ã€‚ |
| **State** | **Zustand** | zustand \+ immer | çŠ¶æ€ç®¡ç†ã€‚ |
| **Drag** | **Dnd-Kit** | @dnd-kit/core | è·¨å±‚çº§æ‹–æ‹½ã€‚ |
| **Export** | **Client-Side** | @react-pdf/renderer | å®¢æˆ·ç«¯å¯¼å‡ºã€‚ |

## **3\. è¯¦ç»†ç›®å½•ç»“æ„ (Directory Structure)**

**å…³é”®å˜æ›´**ï¼šæ‰€æœ‰é¡µé¢è·¯ç”±ç§»å…¥ \[locale\] æ–‡ä»¶å¤¹ï¼›å¢åŠ  messages æ–‡ä»¶å¤¹ã€‚

src/  
â”œâ”€â”€ app/  
â”‚   â”œâ”€â”€ \[locale\]/                  \# ğŸŒ å›½é™…åŒ–è·¯ç”±æ ¹ç›®å½•  
â”‚   â”‚   â”œâ”€â”€ (editor)/  
â”‚   â”‚   â”‚   â””â”€â”€ editor/  
â”‚   â”‚   â”‚       â”œâ”€â”€ layout.tsx     \# ç¼–è¾‘å™¨å¸ƒå±€  
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx       \# å…¥å£  
â”‚   â”‚   â””â”€â”€ layout.tsx             \# å…¨å±€å¸ƒå±€ (åŠ è½½ i18n Provider)  
â”‚   â””â”€â”€ api/                       \# API è·¯ç”± (ä¸èµ° i18n)  
â”œâ”€â”€ messages/                      \# ğŸ—£ï¸ ç¿»è¯‘æ–‡ä»¶  
â”‚   â”œâ”€â”€ en.json  
â”‚   â””â”€â”€ zh.json  
â”œâ”€â”€ components/  
â”‚   â”œâ”€â”€ editor/                    \# ç¼–è¾‘å™¨ç»„ä»¶  
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx            \# (éœ€ä½¿ç”¨ useTranslations)  
â”‚   â”‚   â”œâ”€â”€ Properties.tsx         \# (éœ€ä½¿ç”¨ useTranslations)  
â”‚   â”‚   â””â”€â”€ AIPanel.tsx            \# ğŸ¤– äºŒæœŸé¢„ç•™ï¼šAI å¯¹è¯é¢æ¿  
â”‚   â”œâ”€â”€ canvas/                    \# 3D ç»„ä»¶  
â”‚   â””â”€â”€ ui/                        \# Shadcn åŸºç¡€ç»„ä»¶  
â”œâ”€â”€ store/  
â”‚   â”œâ”€â”€ useDesignStore.ts          \# æ ¸å¿ƒè®¾è®¡æ•°æ®  
â”‚   â””â”€â”€ useAIStore.ts              \# ğŸ¤– äºŒæœŸé¢„ç•™ï¼šAI ç”ŸæˆçŠ¶æ€  
â”œâ”€â”€ lib/  
â”‚   â”œâ”€â”€ i18n/                      \# å›½é™…åŒ–å·¥å…·  
â”‚   â”‚   â””â”€â”€ navigation.ts          \# å°è£… Link, useRouter  
â”‚   â””â”€â”€ utils.ts  
â”œâ”€â”€ middleware.ts                  \# ğŸŒ è·¯ç”±ä¸­é—´ä»¶ (å¤„ç† / \-\> /zh)  
â””â”€â”€ i18n.ts                        \# next-intl é…ç½®

## **4\. å›½é™…åŒ–å¼€å‘è§„èŒƒ (i18n Standards)**

### **4.1 è·¯ç”±ä¸ä¸­é—´ä»¶**

åœ¨ middleware.ts ä¸­é…ç½®é»˜è®¤è¯­è¨€ï¼š

import createMiddleware from 'next-intl/middleware';  
   
export default createMiddleware({  
  locales: \['en', 'zh'\],  
  defaultLocale: 'zh'  
});  
   
export const config \= {  
  matcher: \['/', '/(zh|en)/:path\*'\]  
};

### **4.2 ç»„ä»¶ç¼–å†™è§„èŒƒ (Prompt æç¤º)**

ç»™ Cursor ä¸‹æŒ‡ä»¤æ—¶ï¼Œå¿…é¡»å¼ºè°ƒï¼š

"åˆ›å»ºä¸€ä¸ªç»„ä»¶ SaveButtonã€‚**ä½¿ç”¨ next-intl çš„ useTranslations hook è·å–æ–‡æœ¬ï¼Œä¸è¦ç¡¬ç¼–ç ä¸­æ–‡ã€‚** Key ä¸º Editor.toolbar.saveã€‚"

ä»£ç ç¤ºä¾‹ï¼š

import { useTranslations } from 'next-intl';

export function SaveButton() {  
  const t \= useTranslations('Editor.toolbar'); // å‘½åç©ºé—´  
  return \<Button\>{t('save')}\</Button\>;  
}

### **4.3 æ•°æ®åº“å¤šè¯­è¨€å­—æ®µå¤„ç†**

æ•°æ®åº“ä¸­çš„ç»„ä»¶åç§° (name) æ˜¯ JSONB æ ¼å¼ {"zh": "...", "en": "..."}ã€‚

å‰ç«¯éœ€è¦ä¸€ä¸ªè¾…åŠ©å‡½æ•°æ¥æ˜¾ç¤ºï¼š

// src/lib/utils.ts  
export function getLocalizedText(data: any, locale: string) {  
  if (typeof data \=== 'string') return data;  
  return data\[locale\] || data\['en'\] || '';  
}

## **5\. AI æ™ºèƒ½åŒ–é¢„ç•™æ¶æ„ (AI Readiness)**

ä¸ºäº†äºŒæœŸçš„ "Text-to-Robot"ï¼ˆä¸€å¥è¯ç”Ÿæˆï¼‰å’Œ "AI Copilot"ï¼ˆæ™ºèƒ½é—®ç­”ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¶æ„ä¸­é¢„ç•™æ¥å£ã€‚

### **5.1 AI Store (useAIStore.ts)**

è™½ç„¶ MVP ä¸å®ç°å¤æ‚ AIï¼Œä½†å…ˆå»ºç«‹ Storeã€‚

interface AIState {  
  isGenerating: boolean; // æ˜¯å¦æ­£åœ¨ç”Ÿæˆä¸­  
  suggestion: string | null; // AI ç»™å‡ºçš„ä¼˜åŒ–å»ºè®®  
  // ...  
}

### **5.2 é¢„ç•™æµå¼ UI æ¥å£**

åœ¨ src/components/editor/Sidebar.tsx ä¸­é¢„ç•™ä¸€ä¸ª Tabï¼š

\<TabsContent value="ai\_create"\>  
  {/\* äºŒæœŸåŠŸèƒ½ï¼šåœ¨è¿™é‡Œæ”¾ç½® Prompt è¾“å…¥æ¡† \*/}  
  \<div className="p-4 text-muted-foreground text-sm"\>  
    AI è‡ªåŠ¨ç»„è£…åŠŸèƒ½å³å°†ä¸Šçº¿...  
  \</div\>  
\</TabsContent\>

## **6\. çŠ¶æ€ç®¡ç† (Zustand)**

### **Design Store (useDesignStore.ts)**

æ ¸å¿ƒæ•°æ®ç»“æ„ä¿æŒä¸å˜ï¼Œä½† Metadata éœ€è¦æ”¯æŒå¤šè¯­è¨€å¤‡æ³¨ã€‚

interface DesignState {  
  parts: Record\<string, Part\>;  
  projectMeta: {   
    name: string;   
    odd: { slope: number; environment: string };  
    // ä¸“å®¶å»ºè®®/AIåˆ†æï¼Œå¯èƒ½åŒ…å«å¤šè¯­è¨€  
    analysisNotes: string;   
  };  
  // ... Actions  
}

## **7\. 3D æ ¸å¿ƒä¸å¯¼å‡º (ä¿æŒ v3.3 é€»è¾‘)**

* **3D å¼•æ“**ï¼šR3F \+ Dnd-Kit \+ Use-Gestureã€‚  
* **ä¸¥æ ¼æ ¡éªŒ**ï¼šçº¢ç¯é˜»æ–­å¯¼å‡ºã€‚  
* **å®¢æˆ·ç«¯å¯¼å‡º**ï¼š  
  * **PDF**ï¼šç”Ÿæˆçš„æŠ¥ä»·å•ï¼Œè¡¨å¤´æ–‡å­—éœ€é€šè¿‡ useTranslations è·å–ï¼Œæ”¯æŒä¸­è‹±åˆ‡æ¢ã€‚  
  * **Word**ï¼šç”Ÿæˆçš„æŠ¥å‘Šï¼Œå›ºå®šæ ‡é¢˜ï¼ˆå¦‚â€œå¯è¡Œæ€§åˆ†æâ€ï¼‰éœ€æ ¹æ®å½“å‰ Locale åŠ¨æ€ç”Ÿæˆã€‚

## **8\. å¼€å‘å·¥ä½œæµ (AI Workflow)**

è¯·æŒ‰ä»¥ä¸‹é¡ºåºæŒ‡æŒ¥ AI å®Œæˆå¼€å‘ï¼š

1. **Stage 1: éª¨æ¶ (i18n)**  
   * åˆå§‹åŒ– Next.jsã€‚  
   * **å®‰è£… next-intl**ï¼Œé…ç½® middleware.ts å’Œ i18n.tsã€‚  
   * åˆ›å»º messages/zh.json (å…ˆåªå¡«ä¸­æ–‡)ã€‚  
2. **Stage 2: çŠ¶æ€ä¸æ•°æ®**  
   * ç”Ÿæˆ useDesignStoreã€‚  
3. **Stage 3: 3D æ ¸å¿ƒ**  
   * æ­å»º \<CanvasArea\> (å¼€å¯ preserveDrawingBuffer)ã€‚  
   * å®ç° \<RobotPart\> å’Œ useSnappingã€‚  
4. **Stage 4: UI ä¸ æ ¡éªŒ**  
   * å®ç° Sidebar å’Œ Propertiesã€‚**æ³¨æ„ï¼šæ‰€æœ‰æ–‡æœ¬å¿…é¡»æå–åˆ° json æ–‡ä»¶ä¸­ã€‚**  
5. **Stage 5: å¯¼å‡º**  
   * å®ç° PDF/Word å¯¼å‡ºã€‚**æ³¨æ„ï¼šå¯¼å‡ºæ–‡ä»¶çš„è¯­è¨€åº”ä¸å½“å‰ç•Œé¢è¯­è¨€ä¸€è‡´ã€‚**

è¿™ä»½æ–‡æ¡£é€šè¿‡ **å¼ºåˆ¶ i18n ç»“æ„** å’Œ **é¢„ç•™ AI æ¥å£**ï¼Œç¡®ä¿äº†æ‚¨çš„é¡¹ç›®åœ¨ MVP å‘å¸ƒåï¼Œèƒ½å¤Ÿå¹³æ»‘è¿‡æ¸¡åˆ°äºŒæœŸçš„é«˜çº§åŠŸèƒ½ï¼Œé¿å…äº†â€œå±å±±ä»£ç â€é‡æ„çš„é£é™©ã€‚